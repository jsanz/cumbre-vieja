from pytz import timezone
import requests_cache

session = requests_cache.CachedSession("http_cache", use_cache_dir=True)

LOC_CANARY = timezone("Atlantic/Canary")

IDS = [
    ["9e0a4897b28b4e238726e6312f8f67c1_0", "2021-12-07", "10:30"],
    ["e7fcf6d3728c48a699732b91bc19010d_0", "2021-12-03", "10:15"],
    ["ce639aa2b6714b818cec49db80ea9425_1", "2021-12-01", "10:00"],
    ["3c980c4cb77f42b09f3d2f703090eed0_0", "2021-11-30", "10:20"],
    ["f9a683035bd34555b02de67c40c95a78_0", "2021-11-29", "10:00"],
    ["6ba12eca59444713afd4f4d4cc95f29a_0", "2021-11-26", "10:00"],
    ["6480faedc865482e804f9358fb8361d3_0", "2021-11-24", "10:15"],
    ["81841b79df094cae9ee9f2754b652d9d_0", "2021-11-23", "11:30"],
    ["cf134bd2e1a64963823ce80c326c5aa9_0", "2021-11-22", "11:00"],
    ["1a271ee7cda94ec4be0eb6648046f3b1_0", "2021-11-20", "10:00"],
    ["c43659c48c3b4468bf744c7d8bdbf0c9_0", "2021-11-19", "10:45"],
    ["c5691e213665480e8d95b793d7d8f3e5_0", "2021-11-18", "11:00"],
    ["029b437907ba4c1ca6c5482db375ff8d_0", "2021-11-17", "11:30"],
    ["448d2b63872a45c38e85f19dd1157d93_0", "2021-11-16", "11:30"],
    ["1c8b8b33e5c94bcd994f8bdd91bf9158_0", "2021-11-15", "11:30"],
    ["743c21d032ba40e98c8dba089b76b277_0", "2021-11-13", "11:00"],
    ["355d8914c1e644c8bb3a4dccaa65ed3a_0", "2021-11-12", "12:40"],
    ["6f2b56cb003b43d79f30e1186c5b659f_0", "2021-11-11", "11:00"],
    ["d4ae575dd0a647499327aa494dacca73_0", "2021-11-10", "11:00"],
    ["27db9e905dd0486a9599e255712d2ead_0", "2021-11-09", "11:00"],
    ["20a80d4bf057423aaf4056ef13d591be_0", "2021-11-08", "13:00"],
    ["f2c2135df71346bcb82dc018ce019422_0", "2021-11-05", "12:15"],
    ["5064c75858064595a601b17c2877ef10_0", "2021-11-04", "10:00"],
    ["f2f50f3bcb5a42eab1c56b26a606dec0_0", "2021-11-02", "13:00"],
    ["f2eb801094214c588c40106ba7a0716c_0", "2021-11-01", "09:30"],
    ["d2c0581b08644b4d8cd40f591439b8e7_0", "2021-10-31", "10:15"],
    ["2ca496dc59cc4ffe8470e1a034720cb2_0", "2021-10-28", "11:30"],
    ["128c373ea8634064b7efe2edfa6ee5e4_0", "2021-10-27", "11:30"],
    ["94e4b6609aff4a1cbbcb9a56ed5437b9_0", "2021-10-25", "10:30"],
    ["01f3ec70ebe74be88aa06efcee0d891d_0", "2021-10-23", "11:30"],
    ["817112ace83d489996ac5910306e26ba_0", "2021-10-22", "12:00"],
    ["2184470a8f7341bca0593c7191fccc00_0", "2021-10-21", "11:30"],
    ["507232606f8645909ed6863e4fe92247_0", "2021-10-20", "10:00"],
    ["45394ae50d894b369f31aa16787feffc_0", "2021-10-19", "15:30"],
    ["b2c4f01219234ba88d2dec90f55174a1_0", "2021-10-18", "11:30"],
    ["513d1de2dd0844b88240a65f490600dc_0", "2021-10-17", "12:00"],
    ["042e67a37e1f498082c91b03137a3e8e_0", "2021-10-16", "10:15"],
    ["1694172da82e448f82aa884a4de8892a_0", "2021-10-15", "11:00"],
    ["9f3a6d26474b4599996199dce3e09552_0", "2021-10-14", "13:30"],
    ["24bc16b5741649778d7710eea062ba37_0", "2021-10-14", "10:30"],
    ["9d68af3929734271bb6c7cfafd810a18_0", "2021-10-13", "15:30"],
    ["4603d9dda528406f84b003a88b829e4f_0", "2021-10-13", "12:00"],
    ["0c7a2e1b5e754058a1c22258bf121c7e_0", "2021-10-12", "13:00"],
    ["ce091a70278a45f4a9a7b857a7871586_0", "2021-10-11", "12:00"],
    ["2b8f01906eb946e2bb418ca4cbc7d40c_0", "2021-10-10", "19:00"],
    ["07a6b8b27bdb43d7afe8407fb0734d70_0", "2021-10-10", "12:00"],
    ["4d44773370c64f238e8cef7ff23c9619_0", "2021-10-09", "18:00"],
    ["8516a51114944fa6a28c5d31ccbe2787_0", "2021-10-09", "12:00"],
    ["37c2a63e7ccf49e7b984fd04ea3a0a5f_0", "2021-10-08", "16:00"],
    ["a9257c6f2dc34bb7aac82bdb0640e6cd_0", "2021-10-08", "12:00"],
    ["4f294b87db8142f28997923c2a405fdb_0", "2021-10-07", "12:00"],
    ["f82c1b14cd7844b78985e2e5652e1333_0", "2021-10-06", "19:00"],
    ["0485756faebc417db27ed6215984ec9b_0", "2021-10-05", "19:00"],
    ["e58f8c3cccad44af90e0c4e9f25caa1c_0", "2021-10-05", "12:00"],
    ["f8f18fbcfd27490abcaaa200405714e1_0", "2021-10-04", "17:00"],
    ["1ff24da6c0894eca998965b572ec5fe0_0", "2021-10-04", "11:00"],
    ["eeb31de1903d4025875eb8c934c1208a_0", "2021-10-02", "19:00"],
    ["c201734574ec4f6e85011e7d921d9bcc_0", "2021-10-02", "11:00"],
    ["5464cc4281e34d03a6ba5bdc6a877418_0", "2021-10-01", "18:00"],
    ["4dd2454d578a4b90b56e1413ce47578b_0", "2021-10-01", "11:00"],
    ["fddaa59746a3461eaf0540606361dc11_0", "2021-09-30", "18:00"],
    ["1624ee4de3b742fe8ae8ec6361916b4b_0", "2021-09-29", "12:00"],
    ["da404ef4096a4233a7784410bafece5d_0", "2021-09-28", "19:00"],
    ["bba7c1e51cb64d83803f04d1e48237e6_0", "2021-09-28", "12:00"],
    ["048d1640d4534b8faa86f039710ab5a5_0", "2021-09-27", "18:00"],
    ["0d94ac4ba5384b619470cb5638c05878_0", "2021-09-26", "13:00"],
    ["ad13943f3a2041039e671f5d7623c2ab_0", "2021-09-25", "18:00"],
    ["02a568616ee64cfa89ac5e8de941c132_0", "2021-09-24", "14:00"],
    ["3037f22a00344fbabb34f3f7c9d70ddc_0", "2021-09-20", "12:00"],
]


def download_geojson(geojson_url):
    """
    Get the buildings data for La Palma
    """
    r = session.get(geojson_url)
    if r.status_code != 200:
        raise Exception("Error downloading the buildings GeoJSON")

    r_obj = r.json()

    if "features" not in r_obj:
        raise Exception(f"Returned JSON is not a valid GeoJSON: [{r_obj.keys()}]")

    return r_obj["features"]
